@* Phase Indicator Component - Shows current diagnostic phase context and description *@

<div class="phase-indicator-card card border-0 shadow-sm mb-4">
    <div class="card-body p-3">
        <div class="d-flex align-items-center">
            <div class="phase-icon me-3">
                @GetPhaseIcon()
            </div>
            <div class="phase-content flex-grow-1">
                <h6 class="phase-title mb-1 @GetPhaseColorClass()">
                    @GetPhaseTitle()
                </h6>
                <p class="phase-description mb-0 text-muted">
                    @PhaseDescription
                </p>
            </div>
            <div class="phase-number">
                <span class="badge @GetPhaseBadgeClass() fs-6">
                    @CurrentPhase/3
                </span>
            </div>
        </div>
    </div>
</div>

@code {
    /// <summary>
    /// Current diagnostic phase (1-3)
    /// </summary>
    [Parameter]
    public int CurrentPhase { get; set; } = 1;
    
    /// <summary>
    /// Description of current phase for user context
    /// </summary>
    [Parameter]
    public string PhaseDescription { get; set; } = string.Empty;
    
    protected override void OnParametersSet()
    {
        // Validate parameters
        if (CurrentPhase < 1 || CurrentPhase > 3)
        {
            throw new ArgumentOutOfRangeException(
                nameof(CurrentPhase), 
                "CurrentPhase must be between 1 and 3");
        }
        
        if (string.IsNullOrWhiteSpace(PhaseDescription))
        {
            throw new ArgumentException(
                "PhaseDescription cannot be empty", 
                nameof(PhaseDescription));
        }
    }
    
    /// <summary>
    /// Get the appropriate icon for current phase
    /// </summary>
    private string GetPhaseIcon()
    {
        return CurrentPhase switch
        {
            1 => "🔍", // Magnifying glass - basic assessment
            2 => "🔬", // Microscope - detailed analysis  
            3 => "🎯", // Target - specialist diagnosis
            _ => "📋"  // Clipboard - fallback
        };
    }
    
    /// <summary>
    /// Get the title for current phase
    /// </summary>
    private string GetPhaseTitle()
    {
        return CurrentPhase switch
        {
            1 => "Faza 1: Podstawowa Ocena",
            2 => "Faza 2: Pogłębiona Analiza",
            3 => "Faza 3: Specjalistyczna Diagnoza",
            _ => "Faza Diagnostyczna"
        };
    }
    
    /// <summary>
    /// Get CSS class for phase-specific coloring
    /// </summary>
    private string GetPhaseColorClass()
    {
        return CurrentPhase switch
        {
            1 => "text-phase-1",
            2 => "text-phase-2", 
            3 => "text-phase-3",
            _ => "text-primary"
        };
    }
    
    /// <summary>
    /// Get CSS class for phase badge background
    /// </summary>
    private string GetPhaseBadgeClass()
    {
        return CurrentPhase switch
        {
            1 => "bg-phase-1 text-white",
            2 => "bg-phase-2 text-white",
            3 => "bg-phase-3 text-white", 
            _ => "bg-primary text-white"
        };
    }
    
    /// <summary>
    /// Get CSS class for component container styling
    /// </summary>
    protected string ComponentCssClass => $"phase-{CurrentPhase}";
} 